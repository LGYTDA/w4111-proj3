{% extends "layout.html" %}

{% block content %}
<div class="container">
    <h1>All Students</h1>

    <div class="search-bar">
        <input type="text" id="searchInput" placeholder="Search students...">
    </div>

    {% if students %}
    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Email</th>
            <th>Academic Level</th>
            <th>Year of Study</th>
            <th>Advisor</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody id="studentsTable">
        {% for student in students %}
        <tr>
            <td>{{ student.student_id }}</td>
            <td>{{ student.name }}</td>
            <td>{{ student.email }}</td>
            <td>{{ student.academic_level }}</td>
            <td>{{ student.year_of_study }}</td>
            <td>{{ student.advisor_name or 'None' }}</td>
            <td>
                <a href="/students/{{ student.student_id }}" class="btn">View</a>
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty-state">
        <h3>No students found</h3>
        <p>There are no students in the database yet.</p>
    </div>
    {% endif %}

    <div class="controls">
        <a href="/welcome" class="btn back-btn">Back to Home</a>
    </div>
</div>

<script>
    // Simple search functionality
    document.getElementById('searchInput').addEventListener('keyup', function() {
        const searchValue = this.value.toLowerCase();
        const table = document.getElementById('studentsTable');
        const rows = table.getElementsByTagName('tr');

        for (let i = 0; i < rows.length; i++) {
            let found = false;
            const cells = rows[i].getElementsByTagName('td');

            for (let j = 0; j < cells.length; j++) {
                const cellText = cells[j].textContent || cells[j].innerText;

                if (cellText.toLowerCase().indexOf(searchValue) > -1) {
                    found = true;
                    break;
                }
            }

            if (found) {
                rows[i].style.display = '';
            } else {
                rows[i].style.display = 'none';
            }
        }
    });
</script>
{% endblock %}